# TCP/IP note

## chap2 链路层

### 2.1

TCP/IP协议簇中，链路层主要有三个目的：
- 为IP模块发送和接收IP数据报
- 为ARP模块发送ARP请求和接收ARP应答
- 为RARP模块发送RARP请求和接收RARP应答

### 2.2 以太网 IEEE 802封装

链路层封装标准主要有两种：

- **以太网（RFC 894）**，10Mb/s，地址48bit。
- **IEEE 802（RFC 1042）**

主机需求RFC要求每台internet主机都与一个10Mb/s的以太网电缆连接：
- 必须能发送和接收采用RFC 894（以太网）封装格式的分组。
- 应该能接收与RFC 894混合的RFC 1042（IEEE 802）封装格式的分组。
- 也许能够发送采用RFC 1042格式封装的分组。如果主机能同时发送两种类型的分组数据，那么发送的分组必须是可以设置的，而且默认条件下必须是 RFC 894分组。

**封装格式**

```
# IEEE 802 RFC1042
                      |   802.2LLC   | 802.2SNAP  |
|目的地址|源地址|length|DSAP|SSAP|crtl|orgcode|type|      data       |CRC|
    6       6      2     1    1    1      3     2       38-1492       4
                                              0800      ip数据报
                                                        38-1492
                                              0806  arp请求/应答  PAD
                                                          28      10
                                              8035  rarp请求/应答 PAD
                                                          28      10

# 以太网 RFC894
|目的地址|源地址| type |                   data                      |CRC|
    6       6      2                     46-1500                      4
                 0800    ip数据报
                         46-1500
                 0806    arp请求/应答  PAD
                              28       18
                 8035    rarp请求/应答 PAD
                              28       18
```

按顺序：

- 都使用48bit的目的地址和源地址（802.3允许16bit地址）
- IEEE 802接下来两字节为不包含CRC校验码的后续数据的长度；以太网为后续数据类型
- 以太网数据帧之后为数据；802帧是3字节802.2LLC和5字节的802.2SNAP（子网接入协议），DSAP（目的服务访问点）、SSAP（源服务访问点）值为0xaa，crtl为3，orgcode为0，2字节类型字段同以太网类型字段相同。
- CRC用于校验差错
- 802.3定义的帧最小长度为38字节；以太网帧最小长度为46字节；不足插入PAD字节补足

### 2.3 尾部封装
